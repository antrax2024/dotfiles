(defwidget bar []
  (box :orientation "h"
    (workspaces)
    (rightStuff))
)


(defwidget rightStuff []
  (box :class "rightStuff" :orientation "h" 
       :halign "end"

    (display  :iconFile "/home/gargula/dotfiles/eww/icons/device_pci.svg"
              :value nvidiaStatus
    )

    (display  :iconFile "/home/gargula/dotfiles/eww/icons/cpu.svg"
              :value cpuStatus
    )

    (display  :iconFile "/home/gargula/dotfiles/eww/icons/clockify-blue.svg"
              :value time
    )

  )
)

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
; Workspaces
(defwidget workspaces []
  (box :class "workspaces"
       :orientation "h"
       :halign "start"
       :spacing 15
    (button :onclick "bspc desktop -f 1" 1)
    (button :onclick "bspc desktop -f 2" 2)
    (button :onclick "bspc desktop -f 3" 3)
    (button :onclick "bspc desktop -f 4" 4)

    )
  )
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

(defwidget display [iconFile value]
  (box
    :orientation "h"
    :class "display"
    :valign "center"
    :halign "end"
    (box :class "icon" (image :path iconFile)) 
    (box :class "value" value)
  )
  
)

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
; Variables
(defpoll nvidiaStatus :interval "300ms"
  "/home/gargula/dotfiles/bin/nvidia-status.sh")

(defpoll cpuStatus :interval "500ms"
  "/home/gargula/dotfiles/bin/cpuinfo.py"
)

(defpoll time :interval "1s" 'date "+%H:%M:%S"')
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

(defwindow bar
  :monitor 0
  :windowtype "dock"
  :geometry (geometry :x "0%"
                      :y "0%"
                      :width "100%"
                      :height "32px"
                      :anchor "top center")
  :reserve (struts :side "top" :distance "4%")
  (bar))
